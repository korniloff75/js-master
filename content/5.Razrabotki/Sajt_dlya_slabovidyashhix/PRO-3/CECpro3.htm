<!-- <script type="text/javascript" src="/js/tools/mootools-core.js"></script> -->
<style>
#altObj #altBody{
	position: static;
}
#altObj #altBody #body_main{
	position: static;
}
#altObj #altBody #body_main>*:not(aside),
#altObj #comments{
	display: none;
}
#altObj #altBody #sidebar {
	display: block;
	position: static;
	width: 100%;
}
</style>
<div>
		<input class="imgPU no-size btn min700 DA_del" style="padding: 3px 5px 3px 50px; margin:0 auto; font-size:20px; background: url('{DIR}/assets/eye.gif') no-repeat scroll 3px center, #ddd linear-gradient(#ccc, #eee, #ccc) repeat scroll 0 0;border: 1px solid #58a; border-radius:5px; z-index:9949; position:static; left:5px; top:20px; cursor: url('{DIR}/assets/glasses.png'), pointer;" id="RDS" value="Для слабовидящих" title="Для слабовидящих" type="button">
</div>

<div>
	<h4>Приказ Росстандарта от 29.11.2012 N1789-ст «Об утверждении национального стандарта»</h4>
	<blockquote class="core note">В соответствии с ФЗ от 27 декабря 2012 г. N184-ФЗ «О техническом регулировании» приказываю: Утвердить для добровольного
		применения национальный стандарт РФ ГОСТ 52872-2012 «Интернет-ресурсы. Требования доступности для инвалидов по зрению»,
		с датой введения в действие 1 января 2014 года, взамен ГОСТ Р 52872-2007.</blockquote>
	<p><a href="//protect.gost.ru/document.aspx?control=7&baseC=6&page=1&month=7&year=2014&search=&id=184053" rel="nofollow"
		 target="_blank">ГОСТ Р 52872-2012 ИНТЕРНЕТ-РЕСУРСЫ. ТРЕБОВАНИЯ ДОСТУПНОСТИ ДЛЯ ИНВАЛИДОВ ПО ЗРЕНИЮ</a></p>
</div>

<p>Кому неинтересна лирика - <a href="#install">Инструкция по установке скрипта</a>.</p>

<p>Для <strike>жадных</strike> экономных веб-мастеров -- <a href="/<?=Path::parentFolder(\H::$Dir )?>Free" title="Версия FREE" target="_blank">версия FREE</a>.</p>


<h5>История возникновения версии</h5>

<p>Многие веб-программисты пользуются моим скриптом <b>Версия сайта для слабовидящих PRO-2</b>. Его удобство использования и адаптивность к множеству CMS и дизайнов уже испытаны неоднократно, сам скрипт постоянно обновлялся. При этом у всех пользователей сетевой версии скрипта обновления шли автоматически, без их участия. Кто-то, возможно, даже их не замечал.</p>
<p class="core info">Версия PRO-2 перестала сопровождаться с марта 2017 г. Страница с инструкциями по установке и API версии уничтожена 20.12.2017г. в связи со своей неактуальностью.</p>
<p>С выпуском версии 3.0 ситуация изменилась. Изначально я пытался и ее сделать обратно-совместимой. То есть, чтобы все тонкие настройки, внесенные на сайтах с установленным скриптом сохранились и продолжали работать, но увы, этого не получилось. После пробного запуска версии я протестировал несколько сайтов - и убедился в том, что старые настройки не действуют, а дизайн в режиме <strong>"Для слабовидящих"</strong> сильно плывет.</p>
<p>После этого я вынужден был ввести версионность скрипта. Сделано это для того, чтобы сайты нынешних пользователей скрипта ни в коем случае не пострадали и остались в том же виде, в каком их принимали заказчики. При этом скрипту требуется развиваться и далее, но точки возврата уже нет. Ниже я постараюсь подробнее описать большинство причин, по которым для перехода на новую версию требуется переустановка скрипта на сайте. Итак, подчеркиваю, сайты с установленным скриптом не пострадают, но и не получат новых версий.</p>
<p>После того, как несколько веб-мастеров написали мне, что скрипт, хоть и по-прежнему работает вполне хорошо, но влияет на основной дизайн некоторых сайтов. К примеру, цвета, назначенные в атрибуте <em>style</em> тегов разметки пропадают. Не велика беда - ответил я - ведь стили можно переназначить глобально, в файлах CSS, а тегам прописать соответствующие классы. Это, кстати, был бы более грамотный подход к использованию стилей. Но я не понял всей глубины глубин трагедии, и меня любезно ввели в курс дела. Оказывается, большинство (если не все) визуальных редакторов, при изменении цвета фрагмента текста в них, назначает этот цвет именно локально, в атрибуте <em>style</em>. А переходить с визуального редактора практически никто не соглашается. Поэтому ерундовая, в моих глазах, проблема уже становится почти глобальной. </p>
<p>Чтобы не расстраивать своих заказчиков, я ввел в скрипт костыль, возвращающий исходные цвета сайта при выходе из режима  <strong>"Для слабовидящих"</strong> (далее будет <strong>РДС</strong>) путем перезагрузки страницы, и приступил к созданию новой версии.</p>


<h5>Описание преимуществ версии PRO-3 и ее отличий от прежних версий</h5>

<p>Даже в мыслях нет делать саморекламу или занудствовать техническими терминами, поэтому опишу то, что понять будет не сложно. Стиль будет максимально популярным, насколько это возможно, так что специалистам <strong>javascript</strong> лучше всего этого не читать.</p>
<h6>Идеология изменений</h6>
<p>Для начала мне нужно было изменить именно идеологию алгоритма скрипта, поскольку старая явно не годилась. Одним из последних нововведений в версии 2 стала возможность произвольной смены цвета шрифта сайта. То есть пользователь мог, кликнув на пиктограмму в Панели управления, вызвать цветовую палитру и выбрать нужный ему цвет. Очень неплохая опция на мой взгляд.</p>
<p>Но именно из-за этой опции и начались проблемы. Чтобы сохранить выбранный цвет и назначить его, при навигации по сайту, новой странице, мне нужно было обнулить цвета в локальных стилях. </p>

<ol>
	Итак, мне требовалось реализовать:
	<li>Убрать костыль с перезагрузкой страницы</li>
	<li>Сохранить возможность пользовательской смены цвета шрифта сайта</li>
	<li>Сохранить ВСЕ исходные цвета элементов страницы и восстановить из при выходе из <strong>РДС</strong></li>
	<li>То же с размерами шрифта</li>
	<li>Ускорить работу скрипта и сделать ее максимально незаметрой для пользователя</li>
</ol>

<p>Идеология старых версий заключалась в том, что скрипт работал непосредственно с контентом сайта. То есть, скрипт менял стили самого сайта в <strong>РДС</strong> и восстанавливал сохраненные исходные, пробегаясь по узлам объектной модели. Все изменения, которые не требовали кастомизации под конкретные сайты, вносились в подгружаемом файле стилей. Остальные были прописаны в локальных стилях и тонких настройках скрипта под отдельно взятый сайт.</p>
<p>Решить вышеизложенный список задач при таком подходе было совершенно, на мой взгляд, невозможно. И я решил изменить сам подход, разделив <del>мух и котлеты</del> исходный код обычного режима сайта и код <strong>РДС</strong>.</p>
<p>Этот подход сразу позволил мне закрыть все пункты, включая ускорение работы. Ведь получается, что <strong>РДС</strong> формируется в клоне кода контента еще в обычном режиме сайта. И при переходе в него сайт преображается мнгновенно. Ну, это меня уже в технику понесло. Думаю, очевидно, что описанные подходы в корне несовместимы друг с другом.</p>


<h5>Что получилось:</h5>

<ol>
	<li>Отсутствие перезагрузки страницы как при входе в <strong>РДС</strong>, так и при выходе из него.</li>
	<li>Полная сохранность исходных стилей сайта. Скрипт их больше не касается.</li>
	<li>Сохранились все нововведения предыдущей версии. Ни от чего отказаться не пришлось.</li>
	<li>Скорость работы скрипта увеличилась на порядок. На одной и той же странице примерно <u>в 10 раз!</u> Более того, работа скрипта стала более незаметной для пользователя, поскольку бОльшая ее часть протекает в фоновом режиме.</li>
	<li>Восстановлена возможность внесения дальнейших изменений в сетевые версии скрипта. Предполагается полная совместимость еще как минимум с несколькими мажорными версиями скрипта.</li>
</ol>

<div id="speedTest" class="core note">
	<span style="text-decoration: underline;">Посмотрите, сколько времени займет работа скрипта <strong>PRO-3</strong> на вашем компьютере:</span>
	<p>Время отработки скрипта при загрузке страницы в вашем броузере <span style="white-space:nowrap;">составляет <big><strong id="speedScr">100...300</strong></big> миллисекунд</span>.</p>
</div>

<p>Есть и недостаток новой реализации, как же без него. В HTML-разметке сайта происходит дублирование всех идентификаторов. Вопрос будет решаться в следующих версиях.</p>
<p>Если кому-то покажется, что все это лишь рекламный трюк - пусть кажется и дальше, разубеждать не буду. По мне - все более, чем очевидно.</p>
<p>Первый сайт, на котором была установлена версия 3.0 - <a href="http://school-podosinovets.ru/" target="_blank" rel="nofollow">school-podosinovets.ru</a>. Дата установки - 15.04.2016. Произошло это случайно - это был последний сайт, на котором я устанавливал версию 2.1. Администратор сайта не поменял доступ к Панели управления, и я смог обновить там версию скрипта и перенастроить сайт уже под нее.</p>
<!--  -->

<h4 id=install>Установка скрипта на сайт</h4>
<ol>
	<li><a href="/?module=php/modules/Download.php&file={DIR}assets/&nameZIP=CC-Pro-3" >Скачать архив</a> с файлами скрипта</li>
	<li>Распаковать его себе на сервер в корневой каталог <strong>js</strong>. Если его нет, требуется его создать.</li>
	<li>Написать мне в Обратную связь адрес сайта, на котором вы планируете использовать скрипт и получить от меня письмо с актуальными условиями его приобретения. Без этого пункта скрипт работать не будет.</li>
	<li>Подключить скрипт у себя в сайте, прописав в header:
		<pre><code saldom=noLib>
		<script src="{DIR}/assets/KFF_Lite.min.js" type="text/javascript" charset="utf-8" ant="no"></script>
		<script src="{DIR}/assets/DA_pro_v3_local.prod.js" type="text/javascript" charset="utf-8"></script>
		</code></pre>
	</li>
	<li>Внести дополнительные тонкие настройки, согласно разделу <b>API версии PRO-3</b>.
		<p>Пример таких настроек:</p>
		<pre><code saldom=noLib>
		<script type="text/javascript">
		DizSel.checkUrl = '{DIR}/assets/'; //== Путь к каталогу со скачанным скриптом
		//== Опциональные настройки:
		DizSel.SlabovidButtonParent = _K.G('$.content');

		_K.DR(function() {
			_K.G(DizSel.PU, {top:'unset', bottom:0}) ; //== Перемещение панели управления скриптом вниз сайта
			DizSel.sts.sound = {
				speaker: "ermil" //== Изменение голоса диктора
			}
		});
		</script>
		</code></pre>
	</li>
	<li>Как только будут выполнены все условия по <b>п.3</b> скрипт вскоре заработает.</li>
</ol>

<script>
	DizSel.SlabovidButton = _K.G('#RDS');
	// DizSel.callbacks.push(()=>{
	_K.DR(()=>{
		_K.G('$#menu_block').classList.add('DA_del');
		// Открываем боковую панель
		_K.G('$aside#sidebar').classList.add('opened');
	});

</script>


<h5>Переход на версию PRO-3</h5>

<p>Версия <strong>PRO-3</strong> будет продолжать развиваться.</p>

<p>Если вы оценили проделанную мной работу по улучшению скрипта, можете заказать переход со старой версии через Обратную связь или сразу мне на почту, если не удалили мой адрес.</p>

<div>
<h4 onclick="if(!$('#man' ).text()) $.get('{DIR}/img/API_slabovtd_PRO-3.php').done(function(resp){$('#man').html(resp)}) " title="Открыть" style="font-family: monospace;" class="pointer center">API версии PRO-3 <span class="small">(загружается по клику)</span></h4>
<div style="color: #147; background: rgb(221, 238, 255) none repeat scroll 0% 0%; border: 1px solid; font-size: 14px;" id="man"></div>
</div>