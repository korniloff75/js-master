<p>Если вы заглянули в этот раздел, то вы ещё не знаете, насколько удобные технологии предлагает современный MicroSoft. Да, удивительно, но даже UNIX-системы пока не смогут повторить тех трюков, о которых речь пойдёт ниже. Сразу оговорюсь, что основная система, в которой тестировались все описанные возможности - <b>Windows 8.1</b>x64. Большая часть из них будут работать и в <b>7sp1</b>, но следует помнить, что семёрка поддерживает лишь виртуальные диски с расширением <em>VHD</em>, которые уступают описываемым <em>VHDX</em> по многим параметрам.</p>
<p>Поскольку я хочу описать революционные возможности работы на виртуальных системах без подключения стороннего софта, которые открыл для себя лишь недавно, постараюсь не утонуть в подробностях и следовать принятой терминологии обозначений, что позволит вам воспользоваться поиском для уточнения непонятных деталей. Или спрашивайте в комментариях, но ждать ответ всегда дольше, чем найти его самому.</p>


<h3>Зачем нужны виртуальные диски</h3>

<p>Операционная система, установленная на виртуальном диске, сразу приобретает качества, недоступные ей при установке на обычный раздел физического диска.</p>
<ul>
	<b>Преимущества системы на <em>VHDX</em>:</b>
	<li>Вся система размещается в единственном файле, которым можно оперировать также, как и любым другим файлом;
	</li>
<li>Количество подобных файлов с разными операционными системами ограничивается только объёмом физического носителя;
	</li>
<li>Систему можно разделить на неизменяемую (родительсую) часть, в которую может входить как сама система, так и установленный на неё проверенный софт, и на дочернюю часть. При использовании дочерней части никакие изменения, внесённые в систему, не коснутся родительсокй части. По этой схеме можно создавать целые цепочки файлов, привязанных как родитель - потомок;
	</li>
<li>Можно полностью отказаться от антивируса, поскольку в любой момент можно вернуться к родительской части. При этом, для обеспечения безопасности личных данных вполне будет достаточно <i>файрволла</i>;
	</li>
<li>Для сохранения резервных копий системы не требуется никакого софта, его можно выполнить обычным копированием, в том числе - и на внешние носители;
	</li>
<li>Время установки системы значительно сокращается;
	</li>
<li>Операционную систему можно хранить на внешнем носителе и запускать оттуда.
</li>
</ul>
<p>Вот неполный перечень достоинств использования виртуальных дисков, ради которого я решил отказаться от традиционной установки Windows.</p>
<p>Далее попробуем разобрать все нюансы использования, с которыми я столкнулся на собственном опыте.</p>


<p>Есть уже много программ, автоматизирующих эту операцию, но, на мой взгляд, проще всего использовать встроенную утилиту <a href="/content/100.Stat'i/Windows/11.CMD_Diskpart/" target="_blank">Diskpart</a>, к тому же это очень просто.</p>
<ol>
	<li>Открываем <a href="/content/100.Stat'i/Windows/10.Cmd/" target="_blank">командную строку</a> с правами Администратора.
	<li>В открывшейся консоли вводим команду <code>diskpart</code> [Enter] (после каждой введённой команды).
		<p><img class="toBig" src="{DIR}assets/VHD_dp1.png" alt="Вызов утилиты Diskpart" />"</p>
	<li>Вводим команду <code>create vdisk file=e:\vhd\vd1.vhdx type=expandable maximum=50000</code>, где <em>e:\vhd\vd1.vhdx</em> - путь к создаваемому вами файлу ВД, а значение <em>maximum</em> - задаётся в МБ - максимальный размер будущего диска. Расширяемый тип позволяет создать ВД очень быстро и маленького начального размера. Есть мнения, что тип лучше назначать фиксированный, но я с этим не согласен и сам работаю именно с расширяемым типом.
		<p><img class="toBig" src="{DIR}assets/VHD_dp2.png" alt="Создание виртуального диска" />"</p>
		<p>Собственно, сам виртуальный диск уже создан. Теперь можно его разметить под свои нужды и отформатировать. Всё это можно сделать при помощи Управления дисками, но мы пойдём и дальше по пути CMD.</p>
	<li>Помещаем фокус утилиты на созданном файле: <code>sel vdisk file=e:\vhd\vd1.vhdx</code>
		<p><img class="toBig" src="{DIR}assets/VHD_dp3.png" alt="Выбор виртуального диска" />"</p>
	<li>Монтируем диск в виртуальный привод: <code>attach vdisk</code>
		<p><img class="toBig" src="{DIR}assets/VHD_dp4.png" alt="Монтирование виртуального диска" />"</p>
	<li>Создаём основной раздел без файловой системы: <code>create par primary</code>. Система выдаст предупреждение о необходимости форматирования диска, которое мы проигнорируем.
		<p><img class="toBig" src="{DIR}assets/VHD_dp5.png" alt="Создание раздела" />"</p>
	<li>А теперь форматируем раздел в NTFS: <code>format fs=ntfs label="win 8.1 VHDX" quick</code>
		<p><img class="toBig" src="{DIR}assets/VHD_dp6.png" alt="Форрматирование раздела" />"</p>
		<p><em>label="win 8.1 VHDX"</em> является меткой созданного тома и будет выводиться при просмотре свойств диска. Можете назначить её на своё усмотрение. Теперь, при открытии утилиты Управление дисками, мы видим вполне полноценный рабочий диск.</p>
		<p><img class="toBig" src="{DIR}assets/VHD_dp7.png" alt="Управление дисками - диск 4" />"</p>
</ol>

<p>Всё, виртуальный диск создан и готов к работе. Его использование практически не отличается от использования физических дисков. Например, на него можно установить операционную систему.</p>